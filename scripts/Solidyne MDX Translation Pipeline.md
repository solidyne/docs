
# Solidyne MDX Translation Pipeline

## Overview

This document describes the automated MDX translation pipeline used to translate Spanish documentation (`/docs/es`) into English (`/docs/en`) while preserving:

* MDX structural integrity
* JSX components
* Frontmatter consistency
* Hash-based change detection
* Safe batch processing
* Truncation detection and auto-continuation

The system is designed for:

* Manual review after translation
* Incremental updates
* Future automation (event-driven updates)

---

# 1. Architecture

## Source Structure

```
docs/
├── es/
│   └── <equipment>/
│       ├── file1.mdx
│       └── subfolder/
│           └── file2.mdx
└── en/
    └── <equipment>/
```

The script:

* Recursively scans `/docs/es/<equipment>`
* Replicates folder structure under `/docs/en/<equipment>`
* Translates only when required (hash-based)
* Injects translation metadata into frontmatter

---

# 2. Translation Workflow

## Command

```
node translate-folder.mjs ../es/[folder_name]
```

Optional flags:

```
--dry-run
--force
--only-new
--only-changed
```

### Default Mode

* Translates files that:

  * Do not exist in `/en`
  * Or have different `source_hash`

---

# 3. Hash System

## What is a hash?

A **hash** is a cryptographic fingerprint of a file's content.

We use:

```
SHA-256
```

### Purpose

* Detect content changes in Spanish source files
* Avoid unnecessary re-translation
* Enable incremental update logic

### How it works

1. Spanish file content is hashed
2. Hash stored in English frontmatter
3. On next run:

   * If hash unchanged → file skipped
   * If hash changed → file re-translated

---

# 4. Translation Metadata (Frontmatter)

Every translated EN file contains:

```yaml
translation:
  source_lang: "es"
  status: "draft"
  version: 0
  reviewed_by: ""
  reviewed_at: ""
  source_hash: "08227fc2834f4cffca04b80527394122614fbccb5828776afb4212f39b4bee68"
```

---

# 5. Frontmatter Field Definitions

## source_lang

Language of original file.

```
"es"
```

---

## status

Allowed values:

```
draft
reviewed
updated
```

### Meaning

* **draft** → Machine translated, pending human review
* **reviewed** → Human validated
* **updated** → Reviewed again after source changes

---

## version

Integer.

Purpose:

Tracks number of human revision cycles.

Example:

```
0 → Initial machine translation
1 → First human revision
2 → Second human revision
```

---

## reviewed_by

String.

Name or initials of reviewer.

Example:

```
reviewed_by: "JPD"
```

---

## reviewed_at

ISO 8601 date format (mandatory format):

```
YYYY-MM-DD
```

Example:

```
reviewed_at: "2026-02-21"
```

Do NOT use:

* 21/02/2026
* Feb 21, 2026
* 02-21-26

Always ISO format.

---

## source_hash

SHA-256 hash of original Spanish file.

Automatically generated by script.

Do not edit manually.

---

# 6. Truncation Control System

The pipeline includes robust protection against LLM truncation.

## Problems Observed

Claude sometimes returned:

```
[Continued in next part due to length...]
```

or

```
[Content continues with same careful translation following all rules...]
```

or

```
[Continued translation follows same precise format and rules...]
```

These are placeholders indicating incomplete output.

---

## Current Protection Mechanism

The script:

1. Detects placeholder patterns
2. Detects abrupt MDX endings
3. Automatically requests continuation
4. Allows up to 3 parts
5. Fails explicitly if still truncated

This ensures:

* No incomplete MDX is silently saved
* Batch integrity is preserved
* Errors are visible in JSON report

---

# 7. Token Usage

Typical metrics:

* ~3,000–4,000 tokens per file
* ~5 cents per file average
* Full 237 file batch ≈ $10–15 USD

Rules are intentionally verbose to preserve MDX safety.

We do not optimize rules for token reduction.

Robustness > marginal cost savings.

---

# 8. Review Workflow

## Phase 1 – Batch Translation

Run by equipment folder:

```
docs/es/unidex
docs/es/blt200
docs/es/audicom
```

Review in Mintlify locally.

---

## Phase 2 – Human Review

For each EN file:

1. Validate terminology
2. Adjust phrasing if necessary
3. Update frontmatter:

```yaml
status: "reviewed"
version: 1
reviewed_by: "JPD"
reviewed_at: "2026-02-21"
```

---

## Phase 3 – Future Updates

If ES changes:

* Hash changes
* Script detects difference
* EN re-translated
* status should become:

```
updated
```

Version should increment.

---

# 9. Future Automation Plan

## Goal

When:

* A new ES file is created
* An ES file is modified

Then:

* Automatically translate only modified semantic blocks
* Preserve human-reviewed EN content

---

## Proposed Evolution

Future system may:

* Split MDX into semantic blocks
* Store block hashes externally
* Re-translate only modified blocks
* Preserve manually reviewed sections

No inline markers will be added to MDX (to avoid polluting RAG ingestion).

---

# 10. Design Principles

* Do not modify MDX structure
* Do not alter JSX
* Do not break quoting
* Never output markdown fences
* Never allow silent truncation
* Always use hash-based change detection
* Always require human review before publication

---

# 11. Operational Guidelines

Translate by equipment folder, not by global family.

This ensures:

* Smaller batches
* Easier validation
* Lower error surface
* Better review control

---

# Final State

The pipeline is currently:

* Stable
* Hash-safe
* Truncation-safe
* Batch-ready
* Cost-efficient
* Ready for future incremental automation

---

End of document.
